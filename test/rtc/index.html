<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>FlyInn Web</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon " type="images/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./style/materialize.min.css" />
    <link rel="stylesheet" href="./style/style.css" />
  </head>

  <body>
    <audio id="ringback" style="display: none;" loop="loop">
      <source src="./sound/ringback.ogg" type="audio/ogg" />
    </audio>
    <audio id="ringing" style="display: none;" loop="loop">
      <source src="./sound/ringing.ogg" type="audio/ogg" />
    </audio>
    <div id="welcome-page" class="welcomt-page hPage container valign-wrapper">
      <div class="la-line-scale la-2x blue-text">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
      <h6>FlyInn Web</h6>
    </div>
    <div id="login-page" class="container hPage valign-wrapper row hide">
      <div class="col s12 m8 offset-m2 l6 offset-l3">
        <div class="card">
          <!-- <form action="./index.html" method="GET"> -->
          <div class="card-content">
            <div class="input-field">
              <input id="account" type="text" required name="newAccount" autocomplete="new-password" autofocus="true" class="validate" />
              <label for="account">用户名</label>
            </div>
            <div class="input-field">
              <input id="password" type="password" name="newPassword" autocomplete="new-password" class="validate" />
              <label for="password">密码</label>
            </div>

            <div class="input-field col s4 m4" style="display: none;">
              <select class="codes">
                <option>请选择</option>
                <option value="vp8">VP8</option>
                <option value="vp9">VP9</option>
                <option value="h264">H264</option>
              </select>
              <label>编码优先</label>
            </div>
          </div>

          <div class="card-action">
            <button type="submit" id="login" class="btn waves-effect waves-light fluid">立即登录</button>
          </div>
          <!-- </form> -->
        </div>
      </div>
    </div>
    <div id="main-page" class="container hPage valign-wrapper row hide">
      <div class="row col s12 m8 offset-m2 l6 offset-l3">
        <div class="card col s12">
          <div class="card-content">
            <h4 class="card-title center-align"><span id="registered-user" class="red-text"></span> <small>注册成功</small></h4>
            <div class="input-field row col s12">
              <input id="linkman" type="text" required name="linkman" autocomplete="name" class="validate" />
              <label for="linkman">请输入被叫号码</label>
            </div>

            <div class="row fluid" style="display: none;">
              <label>
                <input type="checkbox" class="tc" />
                <span>transport-cc</span>
              </label>
              <label>
                <input type="checkbox" class="nc" />
                <span>nack</span>
              </label>
              <label>
                <input type="checkbox" class="ncp" />
                <span>nack pli</span>
              </label>
              <label>
                <input type="checkbox" class="gr" checked />
                <span>goog-remb</span>
              </label>
              <label>
                <input type="checkbox" class="ccmf" />
                <span>ccm fir</span>
              </label>
            </div>
          </div>

          <div class="card-action col row s12">
            <button id="logout" type="button" class="btn white-text btn-flat fluid waves-effect waves-light blue-grey col s3">注销</button>
            <button id="call" type="button" class="btn fluid waves-effect waves-light blue col s8 offset-s1">呼叫</button>
          </div>
        </div>
      </div>
    </div>
    <div id="calling-page" class="calling-page hPage hide">
      <div class="animate">
        <div class="preloader-wrapper big active">
          <div class="spinner-layer spinner-blue">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>

          <div class="spinner-layer spinner-red">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>

          <div class="spinner-layer spinner-yellow">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>

          <div class="spinner-layer spinner-green">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>
        </div>
        <h5 class="white-text"><span class="caller"></span> 呼叫中</h5>
      </div>
      <div class="action">
        <a id="cancel" class="btn-floating btn-large waves-effect waves-light red">
          <i class="material-icons">call_end</i>
        </a>
      </div>
    </div>
    <div id="session-page" class="session-page hPage hide">
      <div class="normal video-container">
        <div class="remote">
          <video id="localVideo" autoplay muted playsinline x5-video-player-fullscreen="true" x5-video-player-type="h5"></video>
          <p class="linkman-title">我</p>
        </div>
        <div class="local">
          <video autoplay playsinline x5-video-player-fullscreen="true" x5-video-player-type="h5" id="remoteVideo"></video>
          <p id="caller" class="linkman-title caller"></p>
        </div>
      </div>

      <div class="row fluid" style="display: none;">
        <div class="input-field col s4 m4">
          <select class="selectM">
            <option>请选择</option>
            <option value="low">240p</option>
            <option value="medium">480p</option>
            <option value="high">720p</option>
          </select>
          <label>发送分辨率</label>
        </div>
      </div>

      <div class="row">
        <p>通话时间：<span class="session-timer"></span></p>
        <p>视频参数选择 (供特定场景使用)</p>
        <div class="input-field col s4">
          <select class="asp">
            <option selected value="low">360p</option>
            <option value="medium">480p</option>
            <option value="high">720p</option>
          </select>
          <label>分辨率</label>
        </div>
        <div class="input-field col s4">
          <select class="fps">
            <option value="low">10fps</option>
            <option selected value="medium">15fps</option>
            <option value="high">20fps</option>
            <option value="vhigh">25fps</option>
          </select>
          <label>帧率</label>
        </div>
        <div class="input-field col s4">
          <select class="speed">
            <option selected value="low">512k</option>
            <option value="medium">1M</option>
            <option value="high">1.5M</option>
            <option value="vhigh">2M</option>
          </select>
          <label>带宽</label>
        </div>
        <a class="waves-effect waves-light fluid btn update">确定</a>
      </div>

      <div class="action s12 m8 offset-m2 l4 offset-l4">
        <div>
          <button id="hangup" class="btn-floating waves-effect waves-light red"><i class="material-icons">call_end</i></button>
          <p>挂机</p>
        </div>
        <div>
          <button id="toggle-camera" class="btn-floating waves-effect waves-light indigo darken-1">
            <i class="material-icons video-on">videocam</i><i class="material-icons video-off">videocam_off</i>
          </button>
          <p>开关摄像头</p>
        </div>
        <div>
          <button id="featured" class="btn-floating modal-trigger waves-effect waves-light teal">
            <i class="material-icons vol-off">screen_share</i>
          </button>
          <p>分享桌面</p>
        </div>
        <div>
          <button id="toggle-microphone" class="btn-floating btn-flat waves-effect waves-light indigo darken-1">
            <i class="material-icons mic-on">mic</i>
            <i class="material-icons mic-off">mic_off</i>
          </button>
          <p>开关麦克风</p>
        </div>
        <div>
          <button id="volume" class="btn-floating modal-trigger waves-effect waves-light indigo darken-1">
            <i class="material-icons vol-on">volume_up</i>
            <i class="material-icons vol-off">volume_off</i>
          </button>
          <p>开关声音</p>
        </div>
        <div>
          <button id="change-camera" class="btn-floating waves-effect waves-light green"><i class="material-icons">switch_video</i></button>
          <p>切换摄像头</p>
        </div>
      </div>
      <div id="debug" class="debug col s12 m8 l4 hide"></div>
    </div>
    <div id="incoming-page" class="calling-page hPage hide">
      <div class="animate">
        <h4 id="display-name" class="white-text center-align"></h4>
        <h6 class="white-text">来电</h6>
      </div>
      <div class="action">
        <button id="reject" class="btn-floating btn-large waves-effect waves-light red">
          <i class="material-icons">call_end</i>
        </button>
        <button id="answer" class="btn-floating btn-large waves-effect waves-light green">
          <i class="material-icons">phone</i>
        </button>
      </div>
    </div>
    <span>
      <div id="noServiceModal" class="modal">
        <div class="modal-content">
          <p>当前您的浏览器不支持H5 WebRTC实时音视频通信，Android、Windows和macOS系统建议使用Chrome浏览器，iOS建议使用Safari浏览器</p>
        </div>
      </div>
    </span>
    <script src="./js/jquery-3.3.1.min.js"></script>
    <script src="./js/adapter.min.js"></script>
    <script src="./js/ua-parser.min.js"></script>
    <script src="./js/detect.min.js"></script>
    <script src="./js/materialize.min.js"></script>
    <script>
      M.Modal.init(document.querySelectorAll('#noServiceModal'), {
        dismissible: false,
        opacity: 1,
      });
      var browserSupport = checkSystemRequirements();
      var ERRORCODE = {
        S90201: 'SYSTEM_NAME_ERROR',
        S90202: 'SYSTEM_VER_ERROR',
        S90801: 'BROWSER_NAME_ERROR',
        S90802: 'BROWSER_VER_ERROR',
        S90901: 'WEBSOCKET_SUPPORT_ERROR',
        S90902: 'WEBRTC_SUPPORT_ERROR',
        S90903: 'SWITCH_CAMERA_ERROR',
        S90904: 'SCREENSHARE_ERROR',
      };
      if (browserSupport !== true) {
        // var OS = ua.getOS();
        // switch (OS) {
        //   case 'Windows':
        //   case 'Android':
        //     $('#browser').html('Chrome');
        //     break;
        //   case 'iOS':
        //   case 'Mac OS':
        //     $('#browser').html('Safari');
        //     break;
        //   default:
        //     $('#browser').html('Chrome');
        //     break;
        // }
        $('#noServiceModal').modal('open');
      }
    </script>
    <script src="./js/flyinn-web-demo.min.js"></script>
    <script src="./js/callStats.min.js"></script>
    <script src="./js/vconsole.min.js"></script>
    <script src="./js/config.js"></script>

    <script src="./js/common.js"></script>
    <script src="./js/webrtc.sip.min.js"></script>
    <script src="./js/app.js"></script>
  </body>
</html>
